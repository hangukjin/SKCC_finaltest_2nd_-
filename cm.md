# 1. Create a CDH Cluster on AWS

## a. Linux Setup
#### 1. 1.
```
# sudo useradd training -u 3800
```
#### 1. 2.
```
# sudo passwd training
```
> setting password training
```
passwd: all authentication tokens updated successfully.
```

#### 1. 3.
```
# groupadd skcc
# gpasswd -a training skcc
```

#### 1. 4.
```
# sudo visudo
```
> Add
```
training ALL=(ALL) ALL
```

Check sudo capabilities
```
# su - training
[training@ip-172-31-40-125 ~]$ sudo ls -la /root

[sudo] password for training:
total 36
dr-xr-x---.  3 root root  149 Jun 17 16:28 .
dr-xr-xr-x. 17 root root  224 Jan 28 20:57 ..
-rw-------.  1 root root 6921 Jan 28 21:02 anaconda-ks.cfg

...
```

#### 2.
```
$ cat /etc/resolv.conf

; generated by /usr/sbin/dhclient-script
search ap-northeast-2.compute.internal cdhcluster.com
nameserver 172.31.0.2

...
```

### 3.
```
$ cat /etc/os-release


NAME="CentOS Linux"
VERSION="7 (Core)"
ID="centos"
ID_LIKE="rhel fedora"
VERSION_ID="7"
PRETTY_NAME="CentOS Linux 7 (Core)"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:centos:centos:7"
HOME_URL="https://www.centos.org/"
BUG_REPORT_URL="https://bugs.centos.org/"

CENTOS_MANTISBT_PROJECT="CentOS-7"
CENTOS_MANTISBT_PROJECT_VERSION="7"
REDHAT_SUPPORT_PRODUCT="centos"
REDHAT_SUPPORT_PRODUCT_VERSION="7"
```

### 4.
```
$ mount | grep ^/dev

/dev/nvme0n1p1 on / type xfs (rw,relatime,attr2,inode64,noquota)
```
>xfs

### 5.
```
$ yum repolist

base/7/x86_64 CentOS-7 - Base  10,019
cloudera-manager Cloudera Manager  Version 5.15.2  7
extras/7/x86_64 CentOS-7 - Extras  417
updates/7/x86_64 CentOS-7 - Updates 2,089
repolist: 12,532
=
```

### 6.
```
$ cat /etc/passwd | grep training

training:x:3800:3800::/home/training:/bin/bash
```

### 7.
```
$ cat /etc/group | grep skcc

skcc:x:3801:training
```

### 8.
```
$ getent group skcc

skcc:x:3801:training

$ getent passwd training

training:x:3800:3800::/home/training:/bin/bash
```

## b. Install a MySQL Server

#### 1. 1.
```
$ hostname

master01.cdhcluster.com
```

#### 1. 2.
```sql
mysql> SHOW VARIABLES LIKE "%version%";
```
```
+-------------------------+------------------------------+
| Variable_name           | Value                        |
+-------------------------+------------------------------+
| innodb_version          | 5.6.44                       |
| protocol_version        | 10                           |
| slave_type_conversions  |                              |
| version                 | 5.6.44                       |
| version_comment         | MySQL Community Server (GPL) |
| version_compile_machine | x86_64                       |
| version_compile_os      | Linux                        |
+-------------------------+------------------------------+
7 rows in set (0.00 sec)
```
>5.6.44

#### 1. 3.
```sql
mysql> SHOW DATABASES;
```
```
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
+--------------------+
3 rows in set (0.00 sec)
```

## c. Install Cloudera Manager

#### 1.
```
sudo wget  https://archive.cloudera.com/cm5/redhat/7/x86_64/cm/5.15.2/ -P /etc/yum.repos.d/

sudo rpm --import https://archive.cloudera.com/redhat/cdh/RPM-GPG-KEY-cloudera

sudo yum install cloudera-manager-daemons cloudera-manager-server

sudo yum install cloudera-manager-daemons cloudera-manager-agent
```

![image](https://user-images.githubusercontent.com/28293389/59743181-72d26f00-92aa-11e9-84ce-1ba151bdbd12.png)


# 2.
## 1.
```sql
sql> CREATE DATABASES test
```

## 2.
```
$ mysql -u root -p test < /home/centos/posts23-04-2019-02-44.sql

$ mysql -u root -p test < /home/centos/
authors-23-04-2019-02-34-beta.sql 
```

```sql
mysql> SELECT COUNT(*) FROM posts;
+----------+
| COUNT(*) |
+----------+
|   110000 |
+----------+

mysql> SELECT COUNT(*) FROM authors;
+----------+
| COUNT(*) |
+----------+
|    10000 |
+----------+
1 row in set (0.00 sec)

```
